{
  "info": {
    "_postman_id": "2bd85e3e-d63a-469a-8b8f-da54c9be9952",
    "name": "User API (With Tests)",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "_postman_exported_at": "2025-11-04T00:07:16Z"
  },
  "item": [
    {
      "name": "1️⃣ Create User",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test(\"Code 201\", () => pm.response.to.have.status(201));",
              "pm.test(\"JSON valide\", () => pm.response.to.be.json);",
              "const body = pm.response.json();",
              "pm.test(\"Message OK\", () => body.message && /success/i.test(body.message));",
              "pm.environment.set(\"email\", \"test@gmail.com\");",
              "pm.environment.set(\"password\", \"123456\");"
            ]
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\"email\": \"{{email}}\", \"password\": \"{{password}}\", \"fullName\": \"John Doe\", \"societe\": \"ABC Corp\", \"phoneNumber\": \"98765432\"}"
        },
        "url": {
          "raw": "{{BASE_URL}}/user/createUser",
          "host": [
            "{{BASE_URL}}"
          ],
          "path": [
            "user",
            "createUser"
          ]
        }
      }
    },
    {
      "name": "2️⃣ Login",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test(\"Code 200\", () => pm.response.to.have.status(200));",
              "pm.test(\"JSON valide\", () => pm.response.to.be.json);",
              "const body = pm.response.json();",
              "pm.test(\"Contient token\", () => body.token && body.token.length > 20);",
              "pm.environment.set(\"token\", body.token);",
              "pm.environment.set(\"userId\", body.user && body.user.id ? body.user.id : \"\");"
            ]
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\"email\": \"{{email}}\", \"password\": \"{{password}}\"}"
        },
        "url": {
          "raw": "{{BASE_URL}}/user/login",
          "host": [
            "{{BASE_URL}}"
          ],
          "path": [
            "user",
            "login"
          ]
        }
      }
    },
    {
      "name": "3️⃣ Get Profile (protected)",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test(\"JSON valide\", () => pm.response.to.be.json);",
              "const body = pm.response.json();",
              "if (pm.response.code === 200) {",
              "  pm.test(\"Code 200\", () => pm.response.to.have.status(200));",
              "  pm.test(\"User complet\", () => body.user && body.user.email && body.user.fullName);",
              "} else if (pm.response.code === 401) {",
              "  pm.test(\"Token manquant\", () => /token non fourni/i.test(body.message));",
              "}"
            ]
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{token}}",
            "type": "text"
          }
        ],
        "url": {
          "raw": "{{BASE_URL}}/user/getProfile",
          "host": [
            "{{BASE_URL}}"
          ],
          "path": [
            "user",
            "getProfile"
          ]
        }
      }
    },
    {
      "name": "4️⃣ Update Profile (protected)",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test(\"JSON valide\", () => pm.response.to.be.json);",
              "const body = pm.response.json();",
              "if (pm.response.code === 200) {",
              "  pm.test(\"Code 200\", () => pm.response.to.have.status(200));",
              "  pm.test(\"Mise à jour OK\", () => /updated/i.test(body.message));",
              "  pm.test(\"Objet user renvoyé\", () => body.user && body.user.fullName);",
              "} else if (pm.response.code === 401) {",
              "  pm.test(\"Token manquant\", () => /token non fourni/i.test(body.message));",
              "}"
            ]
          }
        }
      ],
      "request": {
        "method": "PUT",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{token}}",
            "type": "text"
          },
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\"fullName\": \"John Updated\", \"societe\": \"XYZ Corp\", \"phoneNumber\": \"11112222\"}"
        },
        "url": {
          "raw": "{{BASE_URL}}/user/updateProfile",
          "host": [
            "{{BASE_URL}}"
          ],
          "path": [
            "user",
            "updateProfile"
          ]
        }
      }
    },
    {
      "name": "5️⃣ Delete Profile (protected)",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test(\"JSON valide\", () => pm.response.to.be.json);",
              "const body = pm.response.json();",
              "if (pm.response.code === 200) {",
              "  pm.test(\"Code 200\", () => pm.response.to.have.status(200));",
              "  pm.test(\"Suppression OK\", () => /deleted/i.test(body.message));",
              "} else if (pm.response.code === 401) {",
              "  pm.test(\"Token manquant\", () => /token non fourni/i.test(body.message));",
              "}"
            ]
          }
        }
      ],
      "request": {
        "method": "DELETE",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{token}}",
            "type": "text"
          }
        ],
        "url": {
          "raw": "{{BASE_URL}}/user/deleteProfile",
          "host": [
            "{{BASE_URL}}"
          ],
          "path": [
            "user",
            "deleteProfile"
          ]
        }
      }
    },
    {
      "name": "6️⃣ Get Profile By ID",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test(\"JSON valide\", () => pm.response.to.be.json);",
              "const body = pm.response.json();",
              "if (pm.response.code === 200) {",
              "  pm.test(\"Code 200\", () => pm.response.to.have.status(200));",
              "  pm.test(\"ID correspond\", () => body.user && (body.user.id === pm.environment.get(\"userId\")));",
              "} else if (pm.response.code === 404) {",
              "  pm.test(\"Not found\", () => /not found/i.test(body.message));",
              "}"
            ]
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{BASE_URL}}/user/getProfileById/:userId",
          "host": [
            "{{BASE_URL}}"
          ],
          "path": [
            "user",
            "getProfileById",
            ":userId"
          ],
          "variable": [
            {
              "key": "userId",
              "value": "{{userId}}"
            }
          ]
        }
      }
    },
    {
      "name": "7️⃣ Generate CV",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test(\"JSON valide\", () => pm.response.to.be.json);",
              "const body = pm.response.json();",
              "if (pm.response.code === 201) {",
              "  pm.test(\"Code 201\", () => pm.response.to.have.status(201));",
              "  pm.test(\"Lien PDF\", () => body.cvLink && body.cvLink.endsWith(\".pdf\"));",
              "} else if (pm.response.code === 400) {",
              "  pm.test(\"Erreur validation\", () => /invalid input/i.test(body.message));",
              "}"
            ]
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\"personalInfo\": {\"fullName\": \"John Doe\", \"email\": \"john@gmail.com\", \"phoneNumber\": \"99999999\", \"address\": \"Paris\"}, \"experiences\": [{\"position\": \"Dev\", \"company\": \"TechCorp\", \"duration\": \"2 years\", \"description\": \"Backend dev\"}], \"skills\": [\"Node.js\", \"MongoDB\"], \"languages\": [\"English\", \"French\"]}"
        },
        "url": {
          "raw": "{{BASE_URL}}/user/generatecv",
          "host": [
            "{{BASE_URL}}"
          ],
          "path": [
            "user",
            "generatecv"
          ]
        }
      }
    },
    {
      "name": "8️⃣ Get All Profiles",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test(\"JSON valide\", () => pm.response.to.be.json);",
              "const body = pm.response.json();",
              "pm.test(\"Code 200\", () => pm.response.to.have.status(200));",
              "pm.test(\"users est un tableau\", () => Array.isArray(body.users));"
            ]
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{BASE_URL}}/user/getallprofiles",
          "host": [
            "{{BASE_URL}}"
          ],
          "path": [
            "user",
            "getallprofiles"
          ]
        }
      }
    },
    {
      "name": "9️⃣ Delete by ID",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test(\"JSON valide\", () => pm.response.to.be.json);",
              "const body = pm.response.json();",
              "if (pm.response.code === 200) {",
              "  pm.test(\"Code 200\", () => pm.response.to.have.status(200));",
              "  pm.test(\"Suppression OK\", () => /deleted/i.test(body.message));",
              "} else if (pm.response.code === 404) {",
              "  pm.test(\"Not found\", () => /not found/i.test(body.message));",
              "}"
            ]
          }
        }
      ],
      "request": {
        "method": "DELETE",
        "header": [],
        "url": {
          "raw": "{{BASE_URL}}/user/deletebyid/:userId",
          "host": [
            "{{BASE_URL}}"
          ],
          "path": [
            "user",
            "deletebyid",
            ":userId"
          ],
          "variable": [
            {
              "key": "userId",
              "value": "{{userId}}"
            }
          ]
        }
      }
    }
  ]
}